{% extends "core/base.html" %}
{% load static %}

{% block title %}Грузовики - BARLAU.KZ{% endblock %}

{% block content %}
<div class="w-full flex">
    <!-- Боковая панель -->
    <div class="w-64 h-screen bg-white border-r border-zinc-200 flex flex-col justify-start items-start fixed left-0 bottom-0 sidebar">
        <div class="self-stretch px-5 py-6 relative flex flex-col justify-start items-start gap-2 sidebar-logo">
            <div class="py-1 inline-flex justify-start items-center gap-2">
                <img src="{% static 'core/img/logo.png' %}" alt="Barlau Logo" class="w-10 h-6">
                <div class="text-center justify-start text-black text-2xl font-semibold leading-normal">Barlau.kz</div>
            </div>
        </div>
        <div class="self-stretch flex-1 px-4 pt-2 pb-4 flex flex-col justify-start items-center gap-4 sidebar-menu">
            <div class="self-stretch flex flex-col justify-start items-start gap-1">
                <div class="self-stretch flex flex-col justify-start items-start">
                    <a href="{% url 'core:home' %}" class="self-stretch px-3 py-3.5 relative bg-white rounded-lg inline-flex justify-start items-center gap-2">
                        <div class="w-5 h-5 relative overflow-hidden">
                            <img src="{% static 'core/img/home.svg' %}" alt="Home" class="w-4 h-4 desktop-icon">
                            <img src="{% static 'core/img/mobile/home.svg' %}" alt="Home" class="mobile-icon hidden">
                        </div>
                        <div class="flex-1 justify-start text-gray-500 text-base font-medium leading-normal tracking-tight">Главная</div>
                    </a>
                    <a href="{% url 'core:tasks' %}" class="self-stretch px-3 py-3.5 bg-white rounded-lg inline-flex justify-start items-center gap-2">
                        <div class="w-5 h-5 relative overflow-hidden">
                            <img src="{% static 'core/img/check-square.svg' %}" alt="Tasks" class="w-4 h-4 desktop-icon">
                            <img src="{% static 'core/img/mobile/check-square.svg' %}" alt="Tasks" class="mobile-icon hidden">
                        </div>
                        <div class="flex-1 justify-start text-gray-500 text-base font-medium leading-normal tracking-tight">Задачи</div>
                    </a>
                    <a href="{% url 'core:map' %}" class="self-stretch px-3 py-3.5 bg-white rounded-lg inline-flex justify-start items-center gap-2">
                        <div class="w-5 h-5 relative overflow-hidden">
                            <img src="{% static 'core/img/location.svg' %}?v={% now 'U' %}" alt="Map" class="w-4 h-4 desktop-icon" onerror="this.onerror=null; this.src='/static/core/img/location.svg'">
                            <img src="{% static 'core/img/mobile/location.svg' %}" alt="Map" class="mobile-icon hidden">
                        </div>
                        <div class="flex-1 justify-start text-gray-500 text-base font-medium leading-normal tracking-tight">Карта</div>
                    </a>
                    <a href="{% url 'core:trucks' %}" class="self-stretch px-3 py-3.5 bg-gray-50 rounded-lg inline-flex justify-start items-center gap-2 relative">
                        <div class="w-1 h-6 left-0 top-[calc(50%-12px)] absolute bg-blue-600 rounded-tr-lg rounded-br-lg"></div>
                        <div class="w-5 h-5 relative overflow-hidden">
                            <img src="{% static 'core/img/truck.svg' %}" alt="Trucks" class="w-4 h-4 desktop-icon">
                            <img src="{% static 'core/img/mobile/truck.svg' %}" alt="Trucks" class="mobile-icon hidden">
                        </div>
                        <div class="flex-1 justify-start text-blue-600 text-base font-medium leading-normal tracking-tight">Грузовики</div>
                    </a>
                    <a href="{% url 'core:employees' %}" class="self-stretch px-3 py-3.5 bg-white rounded-lg inline-flex justify-start items-center gap-2">
                        <div class="w-5 h-5 relative overflow-hidden">
                            <img src="{% static 'core/img/employee.svg' %}" alt="Employees" class="w-4 h-4 desktop-icon">
                            <img src="{% static 'core/img/mobile/employee.svg' %}" alt="Employees" class="mobile-icon hidden">
                        </div>
                        <div class="flex-1 justify-start text-gray-500 text-base font-medium leading-normal tracking-tight">Сотрудники</div>
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- Основной контент -->
    <div class="ml-64 flex-1 min-h-screen bg-gray-50 main-content">
        <!-- Верхняя панель -->
        <div class="w-full h-20 px-8 py-5 bg-white border-b border-zinc-200 flex justify-between items-center">
            <h1 class="text-2xl font-semibold">Грузовики</h1>
            <div class="flex items-center gap-4">
                <a href="{% url 'core:notifications' %}" class="w-11 h-11 flex items-center justify-center rounded-xl border border-zinc-200 hover:bg-gray-50 transition-colors">
                    <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M7.35419 18.3334C7.98085 18.8534 8.95835 19.1667 10.0001 19.1667C11.0418 19.1667 12.0193 18.8534 12.646 18.3334M15.8334 6.66671C15.8334 5.34059 15.3069 4.0688 14.3692 3.13112C13.4315 2.19344 12.1597 1.66671 10.8334 1.66671C9.50728 1.66671 8.23549 2.19344 7.29781 3.13112C6.36013 4.0688 5.8334 5.34059 5.8334 6.66671C5.8334 9.16671 5.0001 14.1667 3.33344 15.8334H18.3334C16.6668 14.1667 15.8334 9.16671 15.8334 6.66671Z" stroke="#6B7280" stroke-width="1.66667" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                </a>
                <a href="#" class="w-11 h-11 flex items-center justify-center rounded-xl border border-zinc-200 hover:bg-gray-50 transition-colors">
                    <img src="{% static 'core/img/kz.png' %}" alt="Language" class="w-6 h-6 rounded">
                </a>
            </div>
        </div>

        <!-- Панель поиска и добавления -->
        <div class="w-full px-8 pt-8">
            <div class="flex justify-between items-center gap-4">
                <div class="flex-grow relative">
                    <div class="flex h-11 rounded-xl border border-zinc-200 bg-white focus-within:border-blue-500 focus-within:ring-4 focus-within:ring-blue-50 transition-all">
                        <div class="flex items-center pl-4">
                            <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M17.5 17.5L13.875 13.875M15.8333 9.16667C15.8333 12.8486 12.8486 15.8333 9.16667 15.8333C5.48477 15.8333 2.5 12.8486 2.5 9.16667C2.5 5.48477 5.48477 2.5 9.16667 2.5C12.8486 2.5 15.8333 5.48477 15.8333 9.16667Z" stroke="#6B7280" stroke-width="1.66667" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                        </div>
                        <input type="text" placeholder="Поиск грузовиков" class="w-full px-3 py-2 focus:outline-none text-gray-700 rounded-xl">
                    </div>
                </div>
                <a href="{% url 'core:truck-add' %}" class="inline-flex items-center px-4 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-xl gap-2 font-medium transition-colors">
                    <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M10 4.16666V15.8333" stroke="white" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M4.16669 10H15.8334" stroke="white" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    Добавить грузовик
                </a>
            </div>
        </div>

        <!-- Сетка карточек грузовиков -->
        <div class="w-full p-8">
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-4">
                {% for truck in trucks %}
                <a href="{% url 'core:truck-detail' truck.pk %}" class="block group">
                    <div class="bg-white rounded-2xl border border-zinc-200 overflow-hidden hover:border-blue-500 hover:shadow-[0_0_0_1px_rgba(59,130,246,1),0_4px_20px_rgba(59,130,246,0.1)] transition-all duration-200">
                        <div class="flex items-center p-6">
                            <div class="flex-1">
                                <div class="mb-4">
                                    <p class="text-sm text-gray-500 mb-1">{{ truck.brand }} {{ truck.model }}</p>
                                    <h3 class="text-2xl font-semibold text-zinc-950">{{ truck.number }}</h3>
                                </div>
                                
                                <div class="flex items-center gap-8">
                                    <div class="flex items-center gap-8">
                                        {% if truck.driver %}
                                        <div class="flex items-center gap-2 text-gray-600 text-sm">
                                            <svg width="16" height="16" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-shrink-0">
                                                <path d="M13.3332 5.83333C13.3332 7.67428 11.8408 9.16667 9.99984 9.16667C8.15889 9.16667 6.6665 7.67428 6.6665 5.83333C6.6665 3.99238 8.15889 2.5 9.99984 2.5C11.8408 2.5 13.3332 3.99238 13.3332 5.83333Z" stroke="#6B7280" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                                                <path d="M9.99984 11.6667C6.77818 11.6667 4.1665 14.2783 4.1665 17.5H15.8332C15.8332 14.2783 13.2215 11.6667 9.99984 11.6667Z" stroke="#6B7280" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                                            </svg>
                                            <span>{{ truck.driver.get_full_name }}</span>
                                        </div>
                                        {% endif %}
                                        <div class="flex items-center gap-2 text-gray-600 text-sm">
                                            <svg width="16" height="16" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-shrink-0">
                                                <circle cx="10" cy="10" r="7.5" stroke="#6B7280" stroke-width="1.5"/>
                                                <path d="M10 6V10L12.5 12.5" stroke="#6B7280" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                                            </svg>
                                            <span>{{ truck.get_status_display }}</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="w-[240px] h-[90px] flex-shrink-0 rounded-xl overflow-hidden">
                                {% with main=truck.photos.first %}
                                {% if main %}
                                    <img src="{{ main.photo.url }}" alt="Фото грузовика" class="w-full h-full object-cover">
                                {% else %}
                                    <div class="w-full h-full flex items-center justify-center bg-gray-100">
                                        <img src="{% static 'core/img/truck-side.png' %}" alt="Truck" class="w-full h-full object-contain opacity-50">
                                    </div>
                                {% endif %}
                                {% endwith %}
                            </div>
                        </div>
                    </div>
                </a>
                {% empty %}
                <div class="col-span-2 flex flex-col items-center justify-center py-16 bg-white rounded-2xl border border-zinc-200">
                    <div class="w-16 h-16 bg-neutral-100 rounded-full flex items-center justify-center mb-4">
                        <img src="{% static 'core/img/truck.svg' %}" alt="Truck" class="w-8 h-8 opacity-40">
                    </div>
                    <p class="text-lg text-gray-500">Грузовики не найдены</p>
                </div>
                {% endfor %}
            </div>
        </div>
    </div>
</div>

<!-- Нижнее мобильное меню -->
<nav class="fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 hidden max-lg:block">
    <div class="flex justify-around items-center px-4 py-2">
        <a href="{% url 'core:home' %}" class="flex flex-col items-center text-gray-600 hover:text-blue-600">
            <div class="w-6 h-6 relative overflow-hidden">
                <img src="{% static 'core/img/mobile/home.svg' %}" alt="Home" class="w-6 h-6">
            </div>
            <span class="text-xs mt-1">Главная</span>
        </a>
        <a href="{% url 'core:tasks' %}" class="flex flex-col items-center text-gray-600 hover:text-blue-600">
            <div class="w-6 h-6 relative overflow-hidden">
                <img src="{% static 'core/img/mobile/check-square.svg' %}" alt="Tasks" class="w-6 h-6">
            </div>
            <span class="text-xs mt-1">Задачи</span>
        </a>
        <a href="{% url 'core:map' %}" class="flex flex-col items-center text-gray-600 hover:text-blue-600">
            <div class="w-6 h-6 relative overflow-hidden">
                <img src="{% static 'core/img/mobile/location.svg' %}" alt="Map" class="w-6 h-6">
            </div>
            <span class="text-xs mt-1">Карта</span>
        </a>
        <a href="{% url 'core:trucks' %}" class="flex flex-col items-center text-blue-600">
            <div class="w-6 h-6 relative overflow-hidden">
                <img src="{% static 'core/img/mobile/truck.svg' %}" alt="Trucks" class="w-6 h-6">
            </div>
            <span class="text-xs mt-1">Грузовики</span>
        </a>
        <a href="{% url 'core:employees' %}" class="flex flex-col items-center text-gray-600 hover:text-blue-600">
            <div class="w-6 h-6 relative overflow-hidden">
                <img src="{% static 'core/img/mobile/employee.svg' %}" alt="Employees" class="w-6 h-6">
            </div>
            <span class="text-xs mt-1">Сотрудники</span>
        </a>
    </div>
</nav>
{% endblock %} 